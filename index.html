
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>API Reference</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .cd {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .nl {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index" data-languages="[&quot;json&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" alt="Navbar" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo.png" class="logo" alt="Logo" />
        <div class="lang-selector">
              <a href="#" data-language-name="json">json</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc" class="toc-list-h1">
          <li>
            <a href="#introduction" class="toc-h1 toc-link" data-title="introduction">Introduction</a>
          </li>
          <li>
            <a href="#itsme-r-login" class="toc-h1 toc-link" data-title="itsme-r-login">itsme(r) Login</a>
          </li>
          <li>
            <a href="#prerequisites" class="toc-h1 toc-link" data-title="prerequisites">Prerequisites</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#customize-the-user-consent-screen" class="toc-h2 toc-link" data-title="customize-the-user-consent-screen">Customize the user consent screen</a>
                  </li>
                  <li>
                    <a href="#obtain-oauth-2-0-credentials" class="toc-h2 toc-link" data-title="obtain-oauth-2-0-credentials">Obtain OAuth 2.0 credentials</a>
                  </li>
                  <li>
                    <a href="#set-a-redirect-uri-and-certificates" class="toc-h2 toc-link" data-title="set-a-redirect-uri-and-certificates">Set a redirect URI and Certificates</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#service-discovery" class="toc-h1 toc-link" data-title="service-discovery">Service Discovery</a>
          </li>
          <li>
            <a href="#authenticating-the-user" class="toc-h1 toc-link" data-title="authenticating-the-user">Authenticating the user</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#1-authentication-request" class="toc-h2 toc-link" data-title="1-authentication-request">1. Authentication Request</a>
                  </li>
                  <li>
                    <a href="#2-token-request" class="toc-h2 toc-link" data-title="2-token-request">2. Token Request</a>
                  </li>
                  <li>
                    <a href="#3-userinfo-request" class="toc-h2 toc-link" data-title="3-userinfo-request">3. UserInfo Request</a>
                  </li>
                  <li>
                    <a href="#signing-and-encryption-requests" class="toc-h2 toc-link" data-title="signing-and-encryption-requests">Signing and Encryption Requests</a>
                  </li>
                  <li>
                    <a href="#national-id-information" class="toc-h2 toc-link" data-title="national-id-information">National ID Information</a>
                  </li>
                  <li>
                    <a href="#commercial-information" class="toc-h2 toc-link" data-title="commercial-information">Commercial Information</a>
                  </li>
                  <li>
                    <a href="#security-information" class="toc-h2 toc-link" data-title="security-information">Security Information</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#advanced-topics" class="toc-h1 toc-link" data-title="advanced-topics">Advanced topics</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#passing-request-parameters-as-jwts" class="toc-h2 toc-link" data-title="a-name-jwtrequest-a-passing-request-parameters-as-jwts"><a name="JWTRequest"></a>Passing Request Parameters as JWTs</a>
                  </li>
              </ul>
          </li>
      </div>
        <ul class="toc-footer">
            <li><a href='#'>Sign Up for a Developer Key</a></li>
            <li><a href='https://github.com/lord/slate'>Documentation Powered by Slate</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='introduction'>Introduction</h1>
<p>This documentation describes our OAuth 2.0 implementation of <strong>itsme(r) Login</strong>, which conforms to the <a href="http://openid.net/specs/openid-connect-core-1_0.html">OpenID Connect 1.0</a> specifications, and is OpenID certified (TODO). </p>
<h1 id='itsme-r-login'>itsme(r) Login</h1>
<p><strong>itsme(r) Login</strong> is a service provided by <a href="https://www.belgianmobileid.be">Belgian Mobile ID</a> to allow user to login securely and to share verified identity data with your application.</p>
<h1 id='prerequisites'>Prerequisites</h1>
<p>Before your application can use <strong>itsme(r)</strong> for user login, you must set up a project to obtain OIDC credentials, set a redirect URI, and customise the branding information that your users see on the <strong>itsme(r)</strong> user-consent screen.</p>
<h2 id='customize-the-user-consent-screen'>Customize the user consent screen</h2>
<p>SP provides </p>

<ul>
<li>Partner name, description and localized labels</li>
<li>Services&#39; name, description and localized labels</li>
<li>Data access with justification (to comply with GDPR)</li>
</ul>
<h2 id='obtain-oauth-2-0-credentials'>Obtain OAuth 2.0 credentials</h2>
<p>BMID provides Partner Code and Service Code for each Service.</p>
<h2 id='set-a-redirect-uri-and-certificates'>Set a redirect URI and Certificates</h2>
<p>SP provides the redirect URIs for each Service to use within the OpenID Connect protocol to send back the response of the Authentication Request. 
SP provides the JWKSet HTTPS endpoint exposing the signing and encryption public certificates of the SP.
SP provides the SSL/TLS certificate used on the JWKSet HTTPS endpoint of the SP.</p>
<h1 id='service-discovery'>Service Discovery</h1>
<p>To simplify implementations and increase flexibility, OpenID Connect allows the use of a &quot;Discovery document&quot;, a JSON document found at a well-known location containing key-value pairs which provide details about the OpenID Connect provider&#39;s configuration, including the URIs of the authorization, token, userinfo, and public-keys endpoints. The Discovery document for <strong>itsme(r) Login</strong> service may be retrieved from:</p>

<p><a href="https://merchant.itsme.be/oidc/.well-known/openid-configuration">https://merchant.itsme.be/oidc/.well-known/openid-configuration</a>.</p>

<p>Format and content of this document is defined in <a href="https://openid.net/specs/openid-connect-discovery-1_0.html">OpenID Connect Discovery 1.0</a></p>
<h1 id='authenticating-the-user'>Authenticating the user</h1>
<p>itsme(r) Login service is based on the Authorization Code Flow of OpenID Connect 1.0 as defined in <a href="http://openid.net/specs/openid-connect-core-1_0.html#CodeFlowAuth">http://openid.net/specs/openid-connect-core-1_0.html#CodeFlowAuth</a></p>

<p>The Authorization Code Flow goes through the following steps as defined in  <a href="http://openid.net/specs/openid-connect-core-1_0.html#CodeFlowSteps">http://openid.net/specs/openid-connect-core-1_0.html#CodeFlowSteps</a></p>
<h2 id='1-authentication-request'>1. Authentication Request</h2>
<p>As per the OpenID Connect specification <a href="http://openid.net/specs/openid-connect-core-1_0.html#AuthRequest">http://openid.net/specs/openid-connect-core-1_0.html#AuthRequest</a> and <a href="http://openid.net/specs/openid-connect-core-1_0.html#AuthorizationEndpoint">http://openid.net/specs/openid-connect-core-1_0.html#AuthorizationEndpoint</a></p>

<p>The first step is forming an HTTPS request with the appropriate URI parameters. Note the use of HTTPS rather than HTTP in all the steps of this process; HTTP connections are refused. You should retrieve the base URI from the <a href="https://merchant.itsme.be/oidc/.well-known/openid-configuration">Discovery document</a> using the key <code>authorization_endpoint</code>. The following discussion assumes the base URI is <code>https://merchant.itsme.be/oidc/authorization</code>.</p>

<p><strong>itsme(r)</strong> supports the use of the HTTP <code>GET</code> and <code>POST</code> methods. If using the HTTP <code>POST</code> method, the request parameters must be serialized using <a href="http://openid.net/specs/openid-connect-core-1_0.html#FormSerialization">Form Serialization</a>.</p>

<p>For a basic request, specify the following parameters:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Comment</th>
</tr>
</thead><tbody>
<tr>
<td><strong>client_id</strong></td>
<td>Required</td>
<td>MUST be the Partner Code you obtained from BMID during on-boarding process (this information is in the onboarding file TODO).</td>
</tr>
<tr>
<td><strong>response_type</strong></td>
<td>Required</td>
<td>MUST be <code>code</code>.</td>
</tr>
<tr>
<td><strong>scope</strong></td>
<td>Required</td>
<td>MUST contain at least <code>openid</code> or an HTTP ERROR <code>not_implemented</code> will be returned. <code>offline_access</code> value will yield an error. MUST also includes the target service in the form <code>service:&lt;SERVICE_CODE&gt;</code> as provided by BMID during the on-boarding process. <em>**Note</em><em>: Requested data will only be provided based on your current accesses</em>. See XXXXXX (TODO) for list of available data.</td>
</tr>
<tr>
<td><strong>redirect_uri</strong></td>
<td>Required</td>
<td>should be the HTTPS endpoint on your server that will receive the response from <strong>itsme(r)</strong>. This value MUST match one of the values provided to BMID during on-boarding process. <em>**Note</em><em>: the Partner can define different <code>redirect_uri</code> specific to each Service.</em></td>
</tr>
<tr>
<td><strong>state</strong></td>
<td>Optional, but strongly recommended</td>
<td>should include the value of the anti-forgery unique session token, as well as any other information needed to recover the context when the user returns to your application.</td>
</tr>
<tr>
<td><strong>nonce</strong></td>
<td>Optional</td>
<td>a random value generated by your app that enables replay protection when present.</td>
</tr>
<tr>
<td><strong>login_hint</strong></td>
<td>Optional</td>
<td>OPTIONAL and supported, though not recommended. Only phone numbers are supported as <code>login_hint</code>. Format is: <code>\&lt;coutrycode\&gt;+\&lt;phonenumber\&gt;</code>. E.g. <code>login_hint=32+123456789</code>. Usage of claim value <code>phone_number</code> in an encrypted request object is recommended in order to avoid disclosure of phone number of the enduser on the user agent (TODO what does it means?)</td>
</tr>
<tr>
<td><strong>display</strong></td>
<td>Optional</td>
<td>MUST be <code>page</code> if provided. Other values will yield an HTTP ERROR <code>not_implemented</code>.</td>
</tr>
<tr>
<td><strong>prompt</strong></td>
<td>Optional</td>
<td>MUST be <code>consent</code> if provided.</td>
</tr>
<tr>
<td><strong>ui_locales</strong></td>
<td>Optional</td>
<td>Can be used to specify the language to be used by the OpenID login page. Supported languages are: <code>fr</code>, <code>nl</code>, <code>en</code> and <code>de</code>. Any other value will be ignored.</td>
</tr>
<tr>
<td><strong>max_age</strong></td>
<td>Optional</td>
<td>Supported but not used: <strong>itsme(r)</strong> will always actively re-authenticate the End-User.</td>
</tr>
<tr>
<td><strong>acr_values</strong></td>
<td>Optional</td>
<td>OPTIONAL and supported, though not recommended. Possible values are tag:itsmetag:sixdots.be,2016-06:acr_basic, tag:itsmetag:sixdots.be,2016-06:acr_advanced. When multiple values are provided only the most constraining will be used (advanced &gt; basic). If not provided basic level will be used. As there is no such idea of an existing session on itsme Core, even if the acr_values is requested as a voluntarily claim, the acr value returned will always be the more constraining method in the acr_values list, or the authentication will fail. Usage of acr parameter in the request object is recommended over this parameter as it will be signed in the JWT token</td>
</tr>
<tr>
<td><strong>claims</strong></td>
<td>Optional</td>
<td>Not recommended. Usage of claims parameter in the request object is recommended over this parameter as it will be signed in the JWT token, and the data will be encrypted</td>
</tr>
<tr>
<td><strong>request</strong></td>
<td>Optional</td>
<td>See <a href="#JWTRequest">Passing Request Parameters as JWTs</a></td>
</tr>
<tr>
<td><strong>response_mode</strong></td>
<td>Unsupported</td>
<td>Ignored if provided.</td>
</tr>
<tr>
<td><strong>id_token_hint</strong></td>
<td>Unsupported</td>
<td>Ignored if provided.</td>
</tr>
<tr>
<td><strong>claims_locales</strong></td>
<td>Unsupported</td>
<td>None are supported.</td>
</tr>
<tr>
<td><strong>request_uri</strong></td>
<td>Unsupported</td>
<td>N/A TODO</td>
</tr>
<tr>
<td><strong>registration</strong></td>
<td>Unsupported</td>
<td>N/A TODO</td>
</tr>
</tbody></table>
<h3 id='request-examples'>Request Examples</h3>
<blockquote>
<p>Example of a minimal Authorization request</p>
</blockquote>
<pre class="highlight http tab-http"><code><span class="err">GET /authorize?response_type=code
&amp;scope=openid%20profile%20email%20service%3Aclient.registration
&amp;client_id=s6BhdRkqt3
&amp;state=af0ifjsldkj
&amp;redirect_uri=https%3A%2F%2Fclient.example.org%2Fcb
HTTP/1.1
Host: server.itsme.be
</span></code></pre><h3 id='errors'>Errors</h3>
<p>If the authentication is NOT successful, the following errors can be triggered</p>

<table><thead>
<tr>
<th>Error</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>interaction_required</td>
<td>TODO</td>
</tr>
<tr>
<td>invalid_request_object</td>
<td>TODO</td>
</tr>
<tr>
<td>request_uri_not_supported</td>
<td>TODO</td>
</tr>
<tr>
<td>registration_not_supported</td>
<td>TODO</td>
</tr>
</tbody></table>

<p><strong>itsme(r)</strong> Mobile App endpoint : TODO</p>
<h2 id='2-token-request'>2. Token Request</h2>
<p>As per the OpenID Connect specification http://openid.net/specs/openid-connect-core-1_0.html#TokenRequest</p>

<p>As per the specification, with a <code>private_key_jwt</code> for client authentication.</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Comment</th>
</tr>
</thead><tbody>
<tr>
<td><strong>grant_type</strong></td>
<td>REQUIRED</td>
<td>Must be <code>authorization_code</code></td>
</tr>
<tr>
<td><strong>code</strong></td>
<td>REQUIRED</td>
<td>The <code>code</code> value provided in Authorization response</td>
</tr>
<tr>
<td><strong>redirect_uri</strong></td>
<td>REQUIRED</td>
<td>The <code>redirect_uri</code> used in the authorization request</td>
</tr>
<tr>
<td><strong>client_assertion</strong></td>
<td>REQUIRED</td>
<td>Must be provided: private_key_jwt</td>
</tr>
<tr>
<td><strong>client_assertion_type</strong></td>
<td>REQUIRED</td>
<td>Must be <code>urn:ietf:params:oauth:client-assertion-type:jwt-bearer</code></td>
</tr>
</tbody></table>

<p>A valid private_key_jwt token must be provided by the client.</p>

<p>The private_key_jwt must be signed and the JWT token content must have the following properties:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Comment</th>
</tr>
</thead><tbody>
<tr>
<td><strong>sub</strong></td>
<td>The subject of the private_key_jwt (the client ID)</td>
</tr>
<tr>
<td><strong>aud</strong></td>
<td>The token endpoint url</td>
</tr>
<tr>
<td><strong>iss</strong></td>
<td>The issuer of the private_key_jwt (the client ID)</td>
</tr>
<tr>
<td><strong>exp</strong></td>
<td>Expiration time on or after which the ID Token MUST NOT be accepted for processing.</td>
</tr>
<tr>
<td><strong>jti</strong></td>
<td>A unique identifier for the token, which can be used to prevent reuse of the token. These tokens MUST only be used once.</td>
</tr>
</tbody></table>
<h4 id='successful-token-response'>Successful Token Response</h4>
<table><thead>
<tr>
<th>Parameter</th>
<th>Comment</th>
</tr>
</thead><tbody>
<tr>
<td><strong>access_token</strong></td>
<td>Will be provided</td>
</tr>
<tr>
<td><strong>token_type</strong></td>
<td>Bearer</td>
</tr>
<tr>
<td><strong>refresh_token</strong></td>
<td>Won&#39;t be provided</td>
</tr>
<tr>
<td><strong>id_token</strong></td>
<td>the id_token correspoding to the authentication request (signed and encrypted)</td>
</tr>
<tr>
<td><strong>at_hash</strong></td>
<td>OPTIONAL: first version of itsme Core does not produce the at_hash value</td>
</tr>
</tbody></table>
<h3 id='errors-2'>Errors</h3>
<p>As per the OpenID Connect specification <a href="http://openid.net/specs/openid-connect-core-1_0.html#TokenErrorResponse">http://openid.net/specs/openid-connect-core-1_0.html#TokenErrorResponse</a></p>

<p>TODO if specifics</p>
<h2 id='3-userinfo-request'>3. UserInfo Request</h2>
<p>As per the OpenID Connect specification <a href="http://openid.net/specs/openid-connect-core-1_0.html#UserInfoRequest">http://openid.net/specs/openid-connect-core-1_0.html#UserInfoRequest</a></p>

<p>The content type of the response will be <code>application/jwt</code>. The response will be signed and encrypted by BMID using the signing and encryption certificate exposed.</p>

<p>The UserInfo endpoint can be accessed only with a valid access_token, and for a very limited duration after end user authentication: there must be less than 3 minutes between the creation of the user action to be confirmed by the end user on his mobile device, and the access to the UserInfo endpoint (this reflects a constraint set on the SOAP version of the interface).</p>
<h3 id='claims'>Claims</h3>
<p>itsme(r) won&#39;t deliver any aggregated nor distributed claims in the current version.</p>

<p>In current version and in contradiction to the OpenID Connect specification, itsme(r) considers all claims as <strong>Essential</strong>, even if they are requested as a <strong>Voluntary</strong> claim. However, as in a future version, itsme(r)  will make the difference between Essential and Voluntary Claims, Relying Parties should already request claims with appropriate level regarding their business case.</p>

<p>Following values for scope allow access to a predefined sets of Identity Data:</p>

<table><thead>
<tr>
<th>Scope</th>
<th>Data</th>
<th>Claim</th>
</tr>
</thead><tbody>
<tr>
<td><strong>profile</strong></td>
<td>Full Name</td>
<td><code>name</code> or <code>given_name</code> TODO ??? or <code>family_name</code> TODO ???</td>
</tr>
<tr>
<td>-</td>
<td>Gender</td>
<td><code>gender</code></td>
</tr>
<tr>
<td>-</td>
<td>Date of Birth</td>
<td><code>birthdate</code></td>
</tr>
<tr>
<td>-</td>
<td>Language</td>
<td><code>locale</code></td>
</tr>
<tr>
<td><strong>address</strong></td>
<td>Address</td>
<td><code>address</code>, with following subfields: <code>street_address</code> (newline separator \n), <code>locality</code>, <code>postal_code</code>, <code>country</code></td>
</tr>
<tr>
<td><strong>email</strong></td>
<td>E-Mail Address</td>
<td><code>email</code> or <code>email_verified</code> TODO verified???</td>
</tr>
<tr>
<td><strong>phone</strong></td>
<td>Phone Number</td>
<td><code>phone_number</code> or <code>phone\_number\_verified</code></td>
</tr>
</tbody></table>

<p><em>**NOTE</em><em>: Any claim requested by using the scope value can only be obtained from the UserInfo endpoint.</em></p>

<p>We have favored the request of Identity Data in the scope values. However, some Identity Data have to be requested in the “claims” parameter of the Authentication Request. Here are these claims:</p>

<table><thead>
<tr>
<th>Data</th>
<th>Claim</th>
<th>Comment</th>
</tr>
</thead><tbody>
<tr>
<td>User code</td>
<td><strong>sub</strong></td>
<td>TODO</td>
</tr>
<tr>
<td>Nationality</td>
<td><strong>tag:itsmetag:sixdots.be,2016-06:claim_nationality</strong></td>
<td>TODO</td>
</tr>
<tr>
<td>Place of Birth</td>
<td><strong>tag:itsmetag:sixdots.be,2016-06:claim_city_of_birth</strong> and <strong>tag:itsmetag:sixdots.be,2016-06:claim_country_of_birth</strong></td>
<td>TODO</td>
</tr>
<tr>
<td>E-ID Info</td>
<td><strong>tag:itsmetag:sixdots.be,2016-06:claim_eid</strong></td>
<td>TODO</td>
</tr>
<tr>
<td>Passport Number</td>
<td><strong>tag:sixdots.be,2017-05:claim_passport_sn</strong></td>
<td>TODO</td>
</tr>
<tr>
<td>Device</td>
<td><strong>tag:sixdots.be,2017-05:claim_device</strong></td>
<td>see XXXX (TODO URL)</td>
</tr>
<tr>
<td>??? TODO</td>
<td><strong>tag:sixdots.be,2017-05:claim_transaction_info</strong></td>
<td>TODO</td>
</tr>
<tr>
<td>E-ID Picture</td>
<td>TODO</td>
<td>TODO</td>
</tr>
<tr>
<td>NRN</td>
<td>TODO</td>
<td>TODO</td>
</tr>
</tbody></table>

<p>The following standard claims (check http://openid.net/specs/openid-connect-core-1_0.html#StandardClaims) won’t be provided: TODO UNSUPPORTED????</p>

<ul>
<li>middle_name </li>
<li>nickname </li>
<li>preferred_username </li>
<li>picture (supposed to be an url) </li>
<li>website </li>
<li>zoneinfo </li>
<li>updated_at</li>
</ul>
<h2 id='signing-and-encryption-requests'>Signing and Encryption Requests</h2>
<p>Encryption algorithm used: RSA SHA-256 TODO not aligned with</p>

<p>Supported algorithms and encryption methods for:</p>

<ul>
<li>ID Token
-- Encryption Method (enc): A128CBC-HS256
-- Encryption Algorithm (alg): RSA-OAEP
-- Signing Algorithm (alg): RS256</li>
<li>User Info
-- Encryption Method (enc): A128CBC-HS256
-- Encryption Algorithm (alg): RSA-OAEP
-- Signing Algorithm (alg):  RS256</li>
<li>Request Object”
-- Encryption Method (enc): A128CBC-HS256
-- Encryption Algorithm (alg): RSA-OAEP
-- Signing Algorithm (alg): RS256</li>
</ul>

<p>itsme(r) will use pairwise Subject Identifier. TODO</p>

<p>Offline access is not supported. TODO</p>

<p>Dynamic client registration is not allowed. TODO </p>

<p>itsme(r) exposes its signing and encryption keys on a public endpoint (JWKSet) </p>

<blockquote>
<p>https://merchant.itsme.be/oidc/jwkSet</p>
</blockquote>

<p>It is expected that the RP will also expose their signing and encryption keys in such a way. The location of the RP JWKSet must be configured by an itsme administrator during onboarding of RP. The exposed endpoint must be HTTPS </p>
<h2 id='national-id-information'>National ID Information</h2><h2 id='commercial-information'>Commercial Information</h2><h2 id='security-information'>Security Information</h2>
<p>Information about the end user device.</p>

<p>A JSON object with the following keys (only keys with cardinality [1..1] will be always available):</p>

<table><thead>
<tr>
<th>Key</th>
<th>Cardinality</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>os</strong></td>
<td>1..1</td>
<td>the device operating system (supported values: {<code>ANDROID</code>, <code>IOS</code>})</td>
</tr>
<tr>
<td><strong>deviceId</strong></td>
<td>1..1</td>
<td>(regexp = &quot;[a-f0-9]{33}&quot;) the device identifier.</td>
</tr>
<tr>
<td><strong>appName</strong></td>
<td>0..1</td>
<td>the application name.</td>
</tr>
<tr>
<td><strong>appRelease</strong></td>
<td>0..1</td>
<td>the application current release.</td>
</tr>
<tr>
<td><strong>deviceLabel</strong></td>
<td>0..1</td>
<td>the name of the device.</td>
</tr>
<tr>
<td><strong>debugEnabled</strong></td>
<td>0..1</td>
<td>if debug mode is activated.</td>
</tr>
<tr>
<td><strong>osRelease</strong></td>
<td>0..1</td>
<td>Version of the OS running on your Device.</td>
</tr>
<tr>
<td><strong>manufacturer</strong></td>
<td>0..1</td>
<td>Brand of the device manufacturer (‘Apple’ on iOS, device specific on Android).</td>
</tr>
<tr>
<td><strong>hasSimEnabled</strong></td>
<td>0..1</td>
<td>Whether there is a SIM in the Device. Should be always true, as long as BMID keeps forbidding installing itsme on a tablet.</td>
</tr>
<tr>
<td><strong>deviceLockLevel</strong></td>
<td>0..1</td>
<td>The type of action to be performed to unlock the Device. On iOS : TOUCH_ID, PASSCODE or NONE if User protected his Device with TouchID, PIN or nothing.</td>
</tr>
<tr>
<td><strong>smsEnabled</strong></td>
<td>0..1</td>
<td>Can send SMS. On iOS, means it’s an iPhone.</td>
</tr>
<tr>
<td><strong>rooted</strong></td>
<td>0..1</td>
<td>Coming from Gemalto. ‘true’ the device is jailbreaked/rooted.</td>
</tr>
<tr>
<td><strong>imei</strong></td>
<td>0..1</td>
<td>(regexp = &quot;[0-9]{15,17}&quot;) the device IMEI value.</td>
</tr>
<tr>
<td><strong>deviceModel</strong></td>
<td>0..1</td>
<td>Model of the Device. e.g. SAMSUNG GALAXY A5</td>
</tr>
<tr>
<td><strong>msisdn</strong></td>
<td>0..1</td>
<td>the user’s phone number.</td>
</tr>
<tr>
<td><strong>sdkRelease</strong></td>
<td>0..1</td>
<td>Sdk release</td>
</tr>
</tbody></table>

<blockquote>
<p>Example
<code>json
{  
    &quot;os&quot;: &quot;ANDROID&quot;,  
    &quot;appName&quot;: &quot;itsme app&quot;, &quot;appRelease&quot;: &quot;1.17.13&quot;,
    &quot;deviceLabel&quot;: &quot;myDevice&quot;,
    &quot;debugEnabled&quot;: false, 
    &quot;deviceId&quot;: &quot;deviceId&quot;,
    &quot;osRelease&quot;: &quot;Android 4.4.2&quot;, 
    &quot;manufacturer&quot;: &quot;samsung&quot;, 
    &quot;hasSimEnabled&quot;: true,
    &quot;deviceLockLevel&quot;: &quot;touchID&quot;, 
    &quot;smsEnabled&quot;: true,
    &quot;rooted&quot;: false,
    &quot;imei&quot;: &quot;12345678901234567&quot;,
    &quot;deviceModel&quot;: &quot;S8&quot;,  
    &quot;msisdn&quot;: &quot;0412123123&quot;, 
    &quot;sdkRelease&quot;: &quot;1.17.12&quot;  
}
</code></p>
</blockquote>
<h1 id='advanced-topics'>Advanced topics</h1><h2 id='passing-request-parameters-as-jwts'><a name="JWTRequest"></a>Passing Request Parameters as JWTs</h2>
<p>OpenID Connect defines the following Authorization Request parameters to enable Authentication Requests to be signed and optionally encrypted:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Comment</th>
</tr>
</thead><tbody>
<tr>
<td>request</td>
<td>Optional</td>
<td>This parameter enables OpenID Connect requests to be passed in a single, self-contained parameter and to be optionally signed and/or encrypted. The parameter value is a Request Object value, as specified in <a href="http://openid.net/specs/openid-connect-core-1_0.html#RequestObject">Section 6.1</a>. It represents the request as a JWT whose Claims are the request parameters.</td>
</tr>
<tr>
<td>request_uri</td>
<td>Unsupported</td>
<td>Refer to <a href="http://openid.net/specs/openid-connect-core-1_0.html#JWTRequests">JWTRequest</a></td>
</tr>
</tbody></table>

<p>The Request Object is a JWT Token as defined in <a href="https://tools.ietf.org/html/rfc7519">RFC 7519</a>, which contains the following properties:</p>

<table><thead>
<tr>
<th>Property</th>
<th>Required</th>
<th>Comment</th>
</tr>
</thead><tbody>
<tr>
<td><strong>iss</strong></td>
<td>Required</td>
<td>Issuer. Must be the <code>client_id</code></td>
</tr>
<tr>
<td><strong>aud</strong></td>
<td>Required</td>
<td>Audience. Must be <code>https://server.itsme.be</code></td>
</tr>
</tbody></table>

<blockquote>
<p>Example of claim request before base64url encoding, signing and encryption</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="err">//</span><span class="w"> </span><span class="err">JWT</span><span class="w"> </span><span class="err">Registered</span><span class="w"> </span><span class="err">claims</span><span class="w"> </span><span class="err">(https</span><span class="p">:</span><span class="err">//tools.ietf.org/html/rfc</span><span class="mi">7519</span><span class="err">#section</span><span class="mf">-4.1</span><span class="err">)</span><span class="w">
    </span><span class="err">iss</span><span class="p">:</span><span class="w"> </span><span class="s2">"s6BhdRkqt3"</span><span class="p">,</span><span class="w">
    </span><span class="err">aud</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://server.itsme.be"</span><span class="p">,</span><span class="w">
    </span><span class="err">//</span><span class="w"> </span><span class="err">OIDC</span><span class="w"> </span><span class="err">parameters</span><span class="p">,</span><span class="w"> </span><span class="err">must</span><span class="w"> </span><span class="err">reflect</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">values</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">HTTP</span><span class="w"> </span><span class="err">parameters</span><span class="w">
    </span><span class="err">client_id</span><span class="p">:</span><span class="w"> </span><span class="s2">"s6BhdRkqt3"</span><span class="p">,</span><span class="w">
    </span><span class="err">response_type</span><span class="p">:</span><span class="w"> </span><span class="s2">"code"</span><span class="p">,</span><span class="w">
    </span><span class="err">redirect_uri</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://client.example.org/cb"</span><span class="p">,</span><span class="w">
    </span><span class="err">scope</span><span class="p">:</span><span class="w"> </span><span class="s2">"openid email service:client.registration"</span><span class="p">,</span><span class="w">
    </span><span class="err">state</span><span class="p">:</span><span class="w"> </span><span class="s2">"af0ifjsldkj"</span><span class="p">,</span><span class="w">
    </span><span class="err">nonce</span><span class="p">:</span><span class="w"> </span><span class="s2">"n-0S6_WzA2Mj"</span><span class="p">,</span><span class="w">
    </span><span class="err">claims</span><span class="p">:</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="err">userinfo</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"tag:itsmetag:sixdots.be,2016-06:claim_nationality"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="err">id_token</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="err">auth_time</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"essential"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">},</span><span class="w">
            </span><span class="err">acr</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="err">\</span><span class="p">[</span><span class="s2">"tag:itsmetag:sixdots.be,2016-06:acr_securedadvanced"</span><span class="err">\</span><span class="p">]</span><span class="w">        
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<!--stackedit_data:
eyJoaXN0b3J5IjpbNDk0ODgwNzYwXX0=
-->

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="json">json</a>
          </div>
      </div>
    </div>
  </body>
</html>
