
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>itsme® OpenID Connect documentation</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .cd {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .nl {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link href="../stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="../stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="../javascripts/all.js"></script>
  </head>

  <body class="v2 v2_test2" data-languages="[&quot;HTTP&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="../images/navbar.png" alt="Navbar" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="../images/logo.png" class="logo" alt="Logo" />
        <div class="lang-selector">
              <a href="#" data-language-name="HTTP">HTTP</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc" class="toc-list-h1">
          <li>
            <a href="#selecting-your-client-authentication-method" class="toc-h1 toc-link" data-title="selecting-your-client-authentication-method">Selecting your client authentication method</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#private_key_jwt-method" class="toc-h2 toc-link" data-title="private_key_jwt-method">private_key_jwt method</a>
                  </li>
                  <li>
                    <a href="#client_secret_post-method" class="toc-h2 toc-link" data-title="client_secret_post-method">client_secret_post method</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#check-itsme-openid-provider-configuration" class="toc-h1 toc-link" data-title="check-itsme-openid-provider-configuration">Check itsme® OpenID Provider configuration</a>
          </li>
          <li>
            <a href="#building-your-authorization-request" class="toc-h1 toc-link" data-title="building-your-authorization-request">Building your Authorization Request</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#composing-your-base-url" class="toc-h2 toc-link" data-title="composing-your-base-url">Composing your base URL</a>
                  </li>
                  <li>
                    <a href="#requesting-claims-about-the-user-and-the-authentication-event" class="toc-h2 toc-link" data-title="requesting-claims-about-the-user-and-the-authentication-event">Requesting claims about the User and the Authentication event</a>
                  </li>
              </ul>
          </li>
      </div>
        <ul class="toc-footer">
            <li><a href='#'>Sign Up for a Developer Key</a> --></li>
            <li><a href='https://github.com/lord/slate'>Documentation Powered by Slate</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <p><a name="Onboarding"></a></p>
<h1 id='selecting-your-client-authentication-method'>Selecting your client authentication method</h1>
<p>A client authentication method is requied to protect the exhange of entitlement information between us, ensure the requested information get issued to a legitimate service provider and not some other party.</p>

<p>The OpenID Connect Core specifications support multiple authentication methods, but itsme® only supports :
<ul>
  <li><i>&quot;private_key_jwt&quot;</i> : 
  <li><i>&quot;client_secret_post&quot;</i></li>
</ul></p>
<h3 id='private_key_jwt-method'>private_key_jwt method</h3>
<p>This method requires that each party exposes its public keys as a simple JWK Set document on a URI accessible to all, and keep its private set for itself. For itsme®, this URI can be retrieved from the <a href="#OpenIDConfig">itsme® Discovery document</a>, using the <i>&quot;jwks_uri&quot;</i> key.</li></p>

<p>Your private and public keys can be generated using your own tool or via Yeoman. If using Yeoman, you need to install generator-itsme with NPM:</p>

<p><code style=display:block;white-space:pre-wrap>$ npm install -g yo generator-itsme</code></p>

<p>After installation, run the generator:</p>

<p><code style=display:block;white-space:pre-wrap>$ yo itsme</code></p>

<p>The Yeoman tool will generate two files, the jwks_private.json which MUST be stored securely somewhere in your systems, and the jwks_public.json which need to be exposed as a JWK Set on a URI accessible to all parties.</p>

<aside class="notice">Whatever the tool you are chossing to create your key pairs, don't forget to send your JWK Set URI by email to onboarding@itsme.be and we’ll make sure to complete the configuration for you in no time!
</aside>
<h3 id='client_secret_post-method'>client_secret_post method</h3>
<p>This method requires the exchange of a static secret that will be used to authenticate with our Back-End. </p>

<p>The client_secret value will be provided by itsme® when <a href="#Onboarding">registering your project</a>.</p>

<p><a name="OpenIDConfig"></a></p>
<h1 id='check-itsme-openid-provider-configuration'>Check itsme® OpenID Provider configuration</h1>
<p>To simplify implementations and increase flexibility, <a href="https://openid.net/specs/openid-connect-discovery-1_0.html" target="blank">OpenID Connect allows the use of a Discovery Document</a>, a JSON document containing key-value pairs which provide details about itsme® configuration, such as the URIs of the </p>

<ul>
  <li>Authorization, Token and userInfo Endpoints</li>
  <li>supported claims</li>
  <li>JWKSet URL</li>
  <li>...</li>
</ul>

<p>The Discovery document for itsme® can be retrieved from: </p>

<table><thead>
<tr>
<th style="text-align: left">Client Authentication method</th>
<th style="text-align: left">Environment</th>
<th style="text-align: left">URL</th>
</tr>
</thead><tbody>
<tr>
<td style="text-align: left"><strong>private_key_jwt</strong></td>
<td style="text-align: left"><strong>SANDBOX</strong></td>
<td style="text-align: left"><a href="https://idp.e2e.itsme.services/v2/.well-known/openid-configuration" target="blank">https://idp.e2e.itsme.services/v2/.well-known/openid-configuration</a></td>
</tr>
<tr>
<td style="text-align: left">****</td>
<td style="text-align: left"><strong>PRODUCTION</strong></td>
<td style="text-align: left"><a href="https://idp.prd.itsme.services/v2/.well-known/openid-configuration" target="blank">https://idp.prd.itsme.services/v2/.well-known/openid-configuration</a></td>
</tr>
<tr>
<td style="text-align: left"><strong>client_secret_post</strong></td>
<td style="text-align: left"><strong>SANDBOX</strong></td>
<td style="text-align: left"><a href="https://oidc.e2e.itsme.services/clientsecret-oidc/csapi/v0.1/.well-known/openid-configuration" target="blank">https://oidc.e2e.itsme.services/clientsecret-oidc/csapi/v0.1/.well-known/openid-configuration</a></td>
</tr>
<tr>
<td style="text-align: left">****</td>
<td style="text-align: left"><strong>PRODUCTION</strong></td>
<td style="text-align: left"><a href="https://oidc.prd.itsme.services/clientsecret-oidc/csapi/v0.1/.well-known/openid-configuration" target="blank">https://oidc.prd.itsme.services/clientsecret-oidc/csapi/v0.1/.well-known/openid-configuration</a></td>
</tr>
</tbody></table>
<h1 id='building-your-authorization-request'>Building your Authorization Request</h1><h3 id='composing-your-base-url'>Composing your base URL</h3>
<p>You will forg a HTTPS GET request that MUST be sent to the itsme® Authorization Endpoint. The itsme® Authorization Endpoint can be retrieved from one of the <a href="#OpenIDConfig">itsme® Discovery document URL</a>, using the key <i>&quot;authorization_endpoint&quot;</i>.</p>

<p>The OpenID Connect Core specification defines a number of parameters to integrate in the HTTPS GET query string :</p>

<table><thead>
<tr>
<th style="text-align: left">Parameter</th>
<th style="text-align: left">Required</th>
<th style="text-align: left">Description</th>
</tr>
</thead><tbody>
<tr>
<td style="text-align: left"><strong>client_id</strong></td>
<td style="text-align: left">Required</td>
<td style="text-align: left">This is the client ID you received after sharing your organisation details with us.</td>
</tr>
<tr>
<td style="text-align: left"><strong>response_type</strong></td>
<td style="text-align: left">Required</td>
<td style="text-align: left">This defines the processing flow to be used when forming the response. Because itsme® uses the Authorization Code Flow as described above, this value MUST be <i>&quot;code&quot;</i>.</td>
</tr>
<tr>
<td style="text-align: left"><strong>scope</strong></td>
<td style="text-align: left">Required</td>
<td style="text-align: left">The scope parameter allows the application to express the desired scope of the access request. It MUST contain the value <i>&quot;openid&quot;</i> and <i>&quot;service:TEST_code&quot;</i>, by replacing &quot;TEST_code&quot; with the service code you received when registering your project in the <a href="#Onboarding">itsme® B2B portal</a>.<br>You MAY also specify additional scopes, separated by spaces, to request more information about the User. See the <a href="#Data">list</a> below for more information.</br><br>An HTTP ERROR <i>&quot;not_implemented&quot;</i> will be returned if the required values are not specified.</br><br>Unrecognised values will be ignored.</br></td>
</tr>
<tr>
<td style="text-align: left"><strong>redirect_uri</strong></td>
<td style="text-align: left">Required</td>
<td style="text-align: left">This is the URI to which the authentication response will be sent. The Redirection URI MUST use the <i>&quot;https&quot;</i> scheme. The Redirection URI MAY NOT use the <i>&quot;http&quot;</i> or an alternate scheme, such as one that is intended to identify a callback into a native application.<br></br><b>Note</b> : <ul><li>this URI MUST be whitelisted in our systems. So, don&#39;t forget to send your it by email to onboarding@itsme.be and we’ll make sure to complete the configuration for you in no time!</li><li>Regardless of the application you are building you should make sure that your redirect URIs support the Universal links and App links mechanism. Functionally, it will allow you to have only one single link that will either open your desktop web application, your mobile app or your mobile site on the User’s device. Universal links and App links are standard web links (http://mydomain.com) that point to both a web page and a piece of content inside an app. When a Universal Link is opened, the app OS checks to see if any installed app is registered for that domain. If so, the app is launched immediately without ever loading the web page. If not, the web URL is loaded into the webbrowser. The specifications for the implementation of Universal links and App links can be found in the Appendix.</li></ul></td>
</tr>
<tr>
<td style="text-align: left"><strong>state</strong></td>
<td style="text-align: left">Strongly RECOMMENDED</td>
<td style="text-align: left">An opaque value used in the Authentication Request, which will be returned unchanged in the Authorization Code. This parameter SHOULD be used for preventing cross-site request forgery (XRSF). <br>When deciding how to implement this, one suggestion is to use a private key together with some easily verifiable variables, for example, your client ID and a session cookie, to compute a hashed value. This will result in a byte value that will be infeasibility difficult to guess without the private key. After computing such an HMAC, base-64 encode it and pass it to the Authorization  Server as <i>&quot;state&quot;</i> parameter. Another suggestion is to hash the current date and time. This requires your application to save the time of transmission in order to verify it or to allow a sliding period of validity.</br></td>
</tr>
<tr>
<td style="text-align: left"><strong>nonce</strong></td>
<td style="text-align: left">Strongly RECOMMENDED</td>
<td style="text-align: left">A string value used to associate a session with an ID Token, and to mitigate replay attacks. The value is passed through unmodified from the Authentication Request to the ID Token. Sufficient entropy MUST be present in the <i>&quot;nonce&quot;</i> values used to prevent attackers from guessing values. See <a href="http://openid.net/specs/openid-connect-core-1_0.html#NonceNotes" target="blank">OpenID Connect Core specifications</a> for more information.</td>
</tr>
<tr>
<td style="text-align: left"><strong>login_hint</strong></td>
<td style="text-align: left">Optional</td>
<td style="text-align: left">Can be used to pre-fill the phone number field on the itsme® OpenID web page for the User, if your application knows ahead of time which User is trying to authenticate. If provided, this value MUST be a phone number in the format specified for the <i>&quot;phone_number&quot;</i> claim: <i>&quot;<countrycode>+<phonenumber>&quot;</i>. E.g. <i>&quot;login_hint=32+123456789&quot;</i>.</br><br><i>&quot;login_hint&quot;</i> with invalid syntax will be ignored.</br></td>
</tr>
<tr>
<td style="text-align: left"><strong>display</strong></td>
<td style="text-align: left">Optional</td>
<td style="text-align: left">ASCII string value that specifies how the Authorization Server displays the authentication and consent User interface pages to the User. MUST be <i>&quot;page&quot;</i> if provided.<br>Other values will yield an HTTP ERROR <i>&quot;not_implemented&quot;</i>.</br></td>
</tr>
<tr>
<td style="text-align: left"><strong>prompt</strong></td>
<td style="text-align: left">Optional</td>
<td style="text-align: left">Space delimited, case sensitive list of ASCII string values that specifies whether the Authorization Server prompts the User for reauthentication and consent. MUST be <i>&quot;consent&quot;</i> if provided.</td>
</tr>
<tr>
<td style="text-align: left"><strong>ui_locales</strong></td>
<td style="text-align: left">Optional</td>
<td style="text-align: left">User&#39;s preferred languages and scripts for the User interface (e.g.: OpenID web page). Supported values are: <i>&quot;fr&quot;</i>, <i>&quot;nl&quot;</i>, <i>&quot;en&quot;</i> and <i>&quot;de&quot;</i>. Any other value will be ignored.</td>
</tr>
<tr>
<td style="text-align: left"><a name="acrvalues"><strong>acr_values</strong></a></td>
<td style="text-align: left">Optional</td>
<td style="text-align: left">Space-separated string that specifies the acr values that the Authorization Server is being requested to use for processing this Authentication Request, with the values appearing in order of preference.<br>2 values are supported:<ul><li>Basic level - let the User to choose either fingerprint usage (if device is compatible) or PIN<br><i>&quot;http://itsme.services/v2/claim/acr_basic&quot;</i></br></li><li>Advanced level - force the User to use PIN<br><i>&quot;http://itsme.services/v2/claim/acr_advanced&quot;</i></br></li></ul>When multiple values are provided only the most constraining will be used (advanced &gt; basic). If not provided basic level will be used.</br></td>
</tr>
<tr>
<td style="text-align: left"><strong>max_age</strong></td>
<td style="text-align: left">Not supported</td>
<td style="text-align: left">Any supplied value will be ignored.<br>As itsme® does not maintain a session mechanism, an active authentication is always required.</br></td>
</tr>
<tr>
<td style="text-align: left"><strong>response_mode</strong></td>
<td style="text-align: left">Not supported</td>
<td style="text-align: left">Any supplied value will be ignored.</td>
</tr>
<tr>
<td style="text-align: left"><strong>id_token_hint</strong></td>
<td style="text-align: left">Not supported</td>
<td style="text-align: left">Any supplied value will be ignored.</td>
</tr>
<tr>
<td style="text-align: left"><strong>claims_locales</strong></td>
<td style="text-align: left">Not supported</td>
<td style="text-align: left">Any supplied value will be ignored.</td>
</tr>
<tr>
<td style="text-align: left"><strong>registration</strong></td>
<td style="text-align: left">Not supported</td>
<td style="text-align: left">Any supplied value will be ignored.</td>
</tr>
<tr>
<td style="text-align: left"><strong>claims</strong></td>
<td style="text-align: left">Optional</td>
<td style="text-align: left">This parameter is used to request specific claims. The value is a JSON object listing the requested claims. <br>See the <a href="#Data">list</a> below for more information.</br></td>
</tr>
<tr>
<td style="text-align: left"><strong>request_uri</strong></td>
<td style="text-align: left">Optional</td>
<td style="text-align: left">This parameter enables OpenID Connect parameters to be passed by reference. The <i>&quot;request_uri&quot;</i> value is a URL using the https scheme referencing a resource containing a Request Object value, which is a JWT containing the request parameters. <br>When the <i>&quot;request_uri&quot;</i> parameter is used, the OpenID Connect request parameter values contained in the referenced JWT supersede those passed using the OAuth 2.0 request syntax.</br><br>The following validations should be done when using the <i>&quot;request_uri&quot;</i> parameter:</br><ul><li>The values for the <i>&quot;response_type&quot;</i> and <i>&quot;client_id&quot;</i> parameters MUST be filled in the Authentication Request, since they are REQUIRED in the OpenID Connect Core specifications. The values for these parameters MUST match those in the Request Object, if present.</li><li>Even if a <i>&quot;scope&quot;</i> parameter is present in the Request Object value, a <i>&quot;scope&quot;</i> parameter – containing the <i>&quot;openid&quot;</i> scope value to indicate to the underlying OpenID Connect Core logic that this is an OpenID Connect request – MUST always be passed in the Authentication Request.</li><li>You need to store the Request Object resource remotely at a URL the the Authorization Server can access. This URL is the Request URI, <i>&quot;request_uri&quot;</i>. Usage of &#39;localhost&#39; is not permitted.<li>The Request URI MUST contain the port 443 as in this example: https://test.istme.be:443/p/test.</li><li>The Request URI value is a URL using the <i>https</i> scheme.</li></ul><br>Don&#39;t forget to send share this URI by email to onboarding@itsme.be and we’ll make sure to complete the configuration for you in no time!</br><br>If the <i>&quot;request&quot;</i> parameters is used, this parameter MUST NOT be used in the same request.</br></td>
</tr>
<tr>
<td style="text-align: left"><strong>request</strong></td>
<td style="text-align: left">Optional</td>
<td style="text-align: left">If the <i>&quot;request_uri&quot;</i> parameters is used, this parameter MUST NOT be used in the same request.</br></td>
</tr>
</tbody></table>
<h3 id='requesting-claims-about-the-user-and-the-authentication-event'>Requesting claims about the User and the Authentication event</h3>
      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="HTTP">HTTP</a>
          </div>
      </div>
    </div>
  </body>
</html>
